(ns county-stats
  (:require [clojure.string :as string]))

(def csv-str "county_name	student_pct	lacks_stable_housing_pct	households_w_seniors_pct	households_w_children_pct	earned_income_pct	n_apps
Alameda	0.3563768945	0.2677294824	0.08018024462	0.2412782385	0.5326678766	13988
Butte	0.5080440305	0.1858594412	0.04322949777	0.1756985605	0.5432780847	4724
Contra Costa	0.1153344351	0.3199965208	0.1653467931	0.3653996695	0.5514737292	11497
Del Norte	0.09090909091	0.3636363636	0.07438016529	0.3223140496	0.6571428571	121
El Dorado	0.1117424242	0.2840909091	0.09867172676	0.2954545455	0.5284090909	528
Fresno	0.05798177523	0.3431888754	0.0658694771	0.3063786703	0.5177981651	14815
Glenn	0.1862745098	0.2254901961	0.07843137255	0.4117647059	0.5555555556	102
Humboldt	0.261575179	0.2706443914	0.04538939322	0.2114558473	0.5707070707	2095
Marin	0.147826087	0.2347826087	0.1826086957	0.307826087	0.6244541485	1150
Monterey	0.2317148125	0.266441303	0.06545789797	0.4081130916	0.6021126761	3254
Nevada	0.1020710059	0.300295858	0.1022222222	0.3357988166	0.5652173913	676
Orange	0.2124238197	0.2930376028	0.1031821856	0.3267493942	0.5806451613	13619
Placer	0.1573438011	0.2505724567	0.09937684487	0.4131501472	0.5493741307	3057
Sacramento	0.1591106363	0.3682804674	0.07666087421	0.2818989117	0.5355407047	14977
San Diego	0.1853981619	0.323612466	0.0944817128	0.3266673512	0.5749611417	38954
San Francisco	0.322775264	0.2425339367	0.08504531722	0.1779788839	0.4719000892	6630
San Luis Obispo	0.2837009804	0.2457107843	0.08655616943	0.2861519608	0.6036363636	1632
San Mateo	0.1988616151	0.2290999644	0.1416370107	0.408751334	0.6281407035	2811
Santa Barbara	0.649496337	0.1375915751	0.03836463582	0.1861263736	0.6176115802	8736
Santa Clara	0.2	0.2993501219	0.09796747967	0.3841624365	0.6067226891	4925
Santa Cruz	0.5684360382	0.1801911735	0.03828140908	0.163310962	0.5831381733	4917
Siskiyou	0.1088082902	0.4093264249	0.07772020725	0.3367875648	0.5090909091	193
Solano	0.1029380227	0.351704911	0.09330759331	0.3752948745	0.5270684372	4663
Sonoma	0.153437816	0.2886754297	0.1057424741	0.3513650152	0.5326975477	3956
Tehama	0.1075581395	0.2994186047	0.08746355685	0.3895348837	0.6354166667	344
Tulare	0.3005181347	0.3834196891	0.025 0.3367875648	0.5813953488	193
Ventura	0.1758241758	0.2937878448	0.09272563987	0.3870823054	0.600591716	4459
Yolo	0.5718799368	0.1475513428	0.03381795196	0.1759873618	0.6016949153	3165")

(def split-lines (-> csv-str
      (string/split #"\n")))

(def county-data (->> split-lines
     (map #(string/split % #"\t"))))

(def county-names
  (->> county-data
       (map #(first %))
       (drop 1)))


(def total-applicants-columns
  (->> county-data
       (map #(last %))))

(def total-applicants
  (->> total-applicants-columns
       (drop 1)
       (map read-string)
       (reduce +)))

(def percent-applicants
  (->> total-applicants-columns
       (drop 1)
       (map read-string)
       (map #(/ (* 100.0 %) total-applicants))
       (map-indexed (fn [idx item]
                      [(nth county-names idx) item]))))
